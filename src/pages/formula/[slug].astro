---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const seasons = await getCollection("formula");

  return seasons.map((season) => ({
    params: { slug: season.slug },
    props: { season },
  }));
}

const { season } = Astro.props;
const { Content } = await season.render();
---

<BaseLayout title={`${season.data.title} | Formula`}>
  <article class="mx-auto px-6 py-12">
    <!-- Article header -->
    <header class="mb-12">
      <div class="mx-auto max-w-6xl">
        <a
          href="/mpalaourg-astro/formula"
          class="text-sm text-gray-500 dark:text-slate-400 hover:underline mb-4 inline-block"
        >
          ‚Üê Back to Formula
        </a>

        {season.data.featuredImage && (
          <img
            src={season.data.featuredImage}
            alt={season.data.title}
            class="mb-6 w-full rounded-xl"
          />
        )}

        <h1 class="text-4xl font-bold mb-2">
          {season.data.title}
        </h1>
        <p class="text-sm text-gray-500 dark:text-slate-400 mb-4">
          Published on {season.data.date.toLocaleDateString("en-GB")}
        </p>

        {season.data.external?.code && (
          <a
            href={season.data.external.code}
            target="_blank"
            class="inline-block rounded-md border px-3 py-1 text-sm
                   border-gray-300 dark:border-gray-700
                   hover:bg-gray-100 dark:hover:bg-slate-800"
          >
            Code
          </a>
        )}
      </div>
    </header>

    <!-- Article body -->
    <div class="mx-auto max-w-6xl">
      <div
        class="prose prose-neutral prose-tight max-w-none dark:prose-invert text-justify
               dark:prose-headings:text-slate-100
               dark:prose-p:text-slate-300"
      >
        <Content />
      </div>
    </div>
  </article>
</BaseLayout>